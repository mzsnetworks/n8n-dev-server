{"createdAt":"2025-07-14T19:09:25.873Z","updatedAt":"2025-09-05T21:42:26.000Z","id":"Ok1bO3wdBvjttlhF","name":"8-Automate_Lead_Qualification_with_RetellAI_Phone_Agent__OpenAI_GPT___Google_Sheet","active":false,"isArchived":false,"nodes":[{"parameters":{"content":"# Outbound lead qualification call workflow","height":320,"width":1260},"id":"875b4585-68cb-4745-ae9a-3c64528b1c54","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[-1480,940],"typeVersion":1},{"parameters":{"content":"# Inbound call appointment scheduler workflow","height":320,"width":1260,"color":5},"id":"ace5144a-e82a-42c3-8270-cd9c8786f757","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","position":[-1480,1300],"typeVersion":1},{"parameters":{"content":"# Post-call workflow\n## Triggers when a new lead is added in Google Sheets:\n\n### 1 -Sends SMS to remind rep to call in 5 min\n### 2- (Optional delay step)\n### 3- Triggers RetellAI to place an automated call to the lead\n\n## ðŸ’¡ Requires phone numbers to be formatted in E.164","height":1100,"width":1400,"color":4},"id":"d4a86495-02ec-4b6e-a3ad-b467fe39223a","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[-180,500],"typeVersion":1},{"parameters":{"pollTimes":{"item":[{"mode":"everyHour"}]},"documentId":{"__rl":true,"mode":"id","value":"="},"sheetName":{"__rl":true,"mode":"id","value":"="},"event":"rowAdded","options":{}},"id":"f2947325-1d09-41f4-80b8-2645aa9ec679","name":"Detect new lead in Google Sheets","type":"n8n-nodes-base.googleSheetsTrigger","position":[-1400,1040],"typeVersion":1},{"parameters":{"resource":"call","from":"+33600000000","to":"={{ $json['Phone Number'] }}","message":"Hello, thanks for your interest in our roofing services. We'll be calling you shortly to ask about your project!","options":{}},"id":"05e0168f-d424-43df-bb5b-16d18d22645e","name":"Send SMS reminder to call lead in 5 minutes","type":"n8n-nodes-base.twilio","position":[-1100,1040],"typeVersion":1},{"parameters":{"amount":1,"unit":"minutes"},"id":"f77ac1ba-3795-4234-a497-abbb65df9283","name":"Wait 5 minutes before making call","type":"n8n-nodes-base.wait","position":[-780,1040],"webhookId":"344c2d5d-5629-4466-866b-ac6359b3b042","typeVersion":1.1},{"parameters":{"method":"POST","url":"https://api.retellai.com/v2/create-phone-call","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer key_XXXXXXXXX"},{"name":"Content-Type","value":"application/json"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"from_number\": \"+33600000000\",\n  \"to_number\": \"{{ $json['Phone Number'] }}\",\n  \"retell_llm_dynamic_variables\": {\n    \"uuid\": \"{{ $('Detect new lead in Google Sheets').item.json.UUID }}\"\n  }\n}","options":{}},"id":"eb836a70-e2df-4758-a93e-91175e1e9e08","name":"Call new lead using RetellAI","type":"n8n-nodes-base.httpRequest","position":[-480,1040],"typeVersion":4.2},{"parameters":{"httpMethod":"POST","path":"ebd11c9b-129c-4b59-8c27-9a4b567305f7","responseMode":"responseNode","options":{}},"id":"4d71f176-b6b2-40f5-978b-c9c4bfbfa2be","name":"Receive inbound call from RetellAI (webhook)","type":"n8n-nodes-base.webhook","position":[-1400,1400],"webhookId":"ebd11c9b-129c-4b59-8c27-9a4b567305f7","typeVersion":2},{"parameters":{"documentId":{"__rl":true,"mode":"id","value":"="},"sheetName":{"__rl":true,"mode":"id","value":"="},"filtersUI":{"values":[{"lookupColumn":"Phone Number","lookupValue":"={{ $json.body.call_inbound.from_number }}"}]},"options":{}},"id":"95dc2c60-03e0-4e42-b120-893366f1b6f8","name":"Check if phone number exists in Google Sheets","type":"n8n-nodes-base.googleSheets","position":[-940,1400],"typeVersion":4.5},{"parameters":{"respondWith":"json","responseBody":"={\n  \"call_inbound\": {\n    \"dynamic_variables\": {\n        \"name\": \"{{ $json.Name }}\"\n    }\n  }\n}","options":{}},"id":"08c08c35-0b0b-40ee-b370-1a881024216c","name":"Send response to inbound webhook call","type":"n8n-nodes-base.respondToWebhook","position":[-480,1400],"typeVersion":1.1},{"parameters":{"httpMethod":"POST","path":"f8878b78-43ea-4caa-b16c-cde9aaf2e9b1","options":{}},"id":"3ab0c109-e276-4053-b316-83c6bfd811cf","name":"Receive post-call data from RetellAI (webhook)","type":"n8n-nodes-base.webhook","position":[-60,1020],"webhookId":"f8878b78-43ea-4caa-b16c-cde9aaf2e9b1","typeVersion":2},{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"a0e40476-0054-43ec-b7a7-e872d1c6061a","operator":{"name":"filter.operator.equals","type":"string","operation":"equals"},"leftValue":"={{ $json.body.event }}","rightValue":"call_analyzed"}]},"options":{}},"id":"0cf47bd4-61b3-480d-8f05-3af1ea9adeff","name":"Filter for analyzed calls only","type":"n8n-nodes-base.filter","position":[180,1020],"typeVersion":2.2},{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"46590184-4e33-48fd-a9f4-c63b13f88c1f","operator":{"type":"string","operation":"equals"},"leftValue":"={{ $json.body.call.direction }}","rightValue":"outbound"}]},"options":{}},"id":"24d52741-cc90-4940-af57-9450fe8a104a","name":"Check if call was outbound","type":"n8n-nodes-base.if","position":[400,1020],"typeVersion":2.2},{"parameters":{"operation":"update","documentId":{"__rl":true,"mode":"id","value":"="},"sheetName":{"__rl":true,"mode":"id","value":"="},"columns":{"value":{"UUID":"={{ $json.body.call.retell_llm_dynamic_variables.uuid }}","Qualification":"={{ $json.body.call.call_analysis.custom_analysis_data.qualification }}"},"schema":[{"id":"UUID","type":"string","display":true,"removed":false,"required":false,"displayName":"UUID","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Name","type":"string","display":true,"required":false,"displayName":"Name","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Phone Number","type":"string","display":true,"required":false,"displayName":"Phone Number","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Datetime Called","type":"string","display":true,"required":false,"displayName":"Datetime Called","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Qualification","type":"string","display":true,"required":false,"displayName":"Qualification","defaultMatch":false,"canBeUsedToMatch":true},{"id":"row_number","type":"string","display":true,"removed":true,"readOnly":true,"required":false,"displayName":"row_number","defaultMatch":false,"canBeUsedToMatch":true}],"mappingMode":"defineBelow","matchingColumns":["UUID"],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"id":"7e6cc541-8a98-4e1a-8822-914f6423e997","name":"Update lead record in Google Sheets","type":"n8n-nodes-base.googleSheets","position":[640,880],"typeVersion":4.5},{"parameters":{"sendTo":"youremail@gmail.com","subject":"=New Lead - Call Summary","emailType":"text","message":"=Name:\n{{ $json.body.call.call_analysis.custom_analysis_data.first_name }}\n\nNumber:\n{{ $json.body.call.call_analysis.custom_analysis_data.phone_number }}\n\nQualification:\n{{ $json.body.call.call_analysis.custom_analysis_data.qualification }}\n\n\nCall Summary:\n{{ $json.body.call.call_analysis.custom_analysis_data.call_summary }}","options":{}},"id":"57e435f6-5dcd-4e0a-b7ba-d36ddf855fbb","name":"Send call summary email","type":"n8n-nodes-base.gmail","position":[1000,880],"webhookId":"806ec3f9-8bcb-48ef-8e22-9d1ce3b06bf0","typeVersion":2.1},{"parameters":{"modelId":{"__rl":true,"mode":"list","value":"gpt-4.1","cachedResultName":"GPT-4.1"},"messages":{"values":[{"content":"=Analyze this call transcript to identify how the call went and identify possible improvements to the voice prompt:\n\n{{ $json.body.call.transcript }}"}]},"options":{}},"id":"771e1e15-b960-44e3-b5d5-d6e313049cf7","name":"Generate call summary with OpenAI","type":"@n8n/n8n-nodes-langchain.openAi","position":[640,1120],"typeVersion":1.8},{"parameters":{"sendTo":"youremail@gmail.com","subject":"=Roofing Appointment Scheduled","emailType":"text","message":"=New roofing appointment:\n\nClient Name:\n{{ $('Check if call was outbound').item.json.body.call.call_analysis.custom_analysis_data.first_name }}\n\nClient Number:\n{{ $('Check if call was outbound').item.json.body.call.call_analysis.custom_analysis_data.phone_number }}\n\nAvailabilities:\n{{ $('Check if call was outbound').item.json.body.call.call_analysis.custom_analysis_data.availabilities }}\n\n\nCall Summary:\n{{ $('Check if call was outbound').item.json.body.call.call_analysis.call_summary }}\n\n\nChatGPT analysis of how the call went and suggestions for improving the voice prompt:\n{{ $json.message.content }}","options":{}},"id":"6a2b5669-3b36-4e6d-8aaf-2f082016f085","name":"Send confirmation email to lead","type":"n8n-nodes-base.gmail","position":[1000,1120],"webhookId":"453fe9d9-1de6-40a2-bd0c-88cb9c1cc7ef","typeVersion":2.1},{"parameters":{"content":"# âœ… General Workflow Explanation\n##  This workflow automates outbound and inbound lead calls with RetellAI, Google Sheets, OpenAI, and Gmail. It handles:\n\nScheduling and reminding outbound qualification calls\nHandling inbound appointment calls\nAutomatically updating records and sending summaries post-call\n\n## ðŸ‘‰ Dependencies:\n\nActive RetellAI API key\nGoogle Sheet set up with lead data\nGmail API credentials configured","height":400,"width":1260},"id":"2825c243-2fa5-4c51-bc01-442d1b5b7e0b","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[-1480,500],"typeVersion":1},{"parameters":{"content":"## External Setup Guide\n[Guide](https://dr-firas.vip/)","height":80,"width":300},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-1480,400],"id":"4dd6a48f-e383-4397-adc9-fccd226bd6fd","name":"Sticky Note5"}],"connections":{"Check if call was outbound":{"main":[[{"node":"Update lead record in Google Sheets","type":"main","index":0}],[{"node":"Generate call summary with OpenAI","type":"main","index":0}]]},"Filter for analyzed calls only":{"main":[[{"node":"Check if call was outbound","type":"main","index":0}]]},"Detect new lead in Google Sheets":{"main":[[{"node":"Send SMS reminder to call lead in 5 minutes","type":"main","index":0}]]},"Generate call summary with OpenAI":{"main":[[{"node":"Send confirmation email to lead","type":"main","index":0}]]},"Wait 5 minutes before making call":{"main":[[{"node":"Call new lead using RetellAI","type":"main","index":0}]]},"Update lead record in Google Sheets":{"main":[[{"node":"Send call summary email","type":"main","index":0}]]},"Send SMS reminder to call lead in 5 minutes":{"main":[[{"node":"Wait 5 minutes before making call","type":"main","index":0}]]},"Receive inbound call from RetellAI (webhook)":{"main":[[{"node":"Check if phone number exists in Google Sheets","type":"main","index":0}]]},"Check if phone number exists in Google Sheets":{"main":[[{"node":"Send response to inbound webhook call","type":"main","index":0}]]},"Receive post-call data from RetellAI (webhook)":{"main":[[{"node":"Filter for analyzed calls only","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true,"instanceId":"cd8ff33dde04e389346982f06c7f2feed2561d3ea2af8c05544f44d32c7108d4"},"pinData":{},"versionId":"af2ec08c-842b-479f-a33b-763880616930","triggerCount":0,"shared":[{"createdAt":"2025-09-05T19:44:08.775Z","updatedAt":"2025-09-05T19:44:08.775Z","role":"workflow:owner","workflowId":"Ok1bO3wdBvjttlhF","projectId":"UeEOi7Hou8inJPiR"}],"tags":[{"createdAt":"2025-07-09T21:41:38.773Z","updatedAt":"2025-07-09T21:41:38.773Z","id":"G5Lcoe2jTgqCJuSy","name":"OpenAI"},{"createdAt":"2025-07-09T23:31:21.052Z","updatedAt":"2025-07-09T23:31:21.052Z","id":"JXtwH1KWn3HpvHrm","name":"templates"},{"createdAt":"2025-07-09T23:31:21.059Z","updatedAt":"2025-07-09T23:31:21.059Z","id":"giPr8wYqaJHn1OWx","name":"creator"},{"createdAt":"2025-07-09T21:41:38.763Z","updatedAt":"2025-07-09T21:41:38.763Z","id":"pz5LfYMpyppJnoPT","name":"WooCommerce"}]}